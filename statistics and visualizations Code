import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

flights_data = pd.read_csv('flights.csv')
hotels_data = pd.read_csv('hotels.csv')
users_data = pd.read_csv('users.csv')

# Flights Data Statistics
print("Flights Data Statistics:")
print(flights_data.describe())
print("Median of Flight Prices:", flights_data['price'].median())
print("Variance of Flight Prices:", flights_data['price'].var())
print("Standard Deviation of Flight Prices:", flights_data['price'].std())

# Hotels Data Statistics
print("\nHotels Data Statistics:")
print(hotels_data.describe())
print("Median of Hotel Prices:", hotels_data['price'].median())
print("Variance of Hotel Prices:", hotels_data['price'].var())
print("Standard Deviation of Hotel Prices:", hotels_data['price'].std())

# Users Data Statistics
print("\nUsers Data Statistics:")
print(users_data.describe())

#  Create visualizations to show the distribution of key variables

# Flights Data Visualizations
plt.figure(figsize=(10, 6))
sns.histplot(flights_data['price'], bins=30, kde=True)
plt.title('Histogram of Flight Prices')
plt.xlabel('Price')
plt.ylabel('Frequency')
plt.show()

plt.figure(figsize=(8, 5))
sns.boxplot(y=flights_data['price'])
plt.title('Box Plot of Flight Prices')
plt.ylabel('Price')
plt.show()

plt.figure(figsize=(8, 5))
sns.countplot(x='flightType', data=flights_data)
plt.title('Bar Plot of Flight Types')
plt.xlabel('Flight Type')
plt.ylabel('Count')
plt.show()

# Hotels Data Visualizations
plt.figure(figsize=(10, 6))
sns.histplot(hotels_data['price'], bins=30, kde=True)
plt.title('Histogram of Hotel Prices')
plt.xlabel('Price')
plt.ylabel('Frequency')
plt.show()

plt.figure(figsize=(12, 6))
sns.boxplot(x='place', y='price', data=hotels_data)
plt.title('Box Plot of Hotel Prices by City')
plt.xlabel('City')
plt.ylabel('Price')
plt.xticks(rotation=45)
plt.show()

plt.figure(figsize=(8, 5))
sns.countplot(x='name', data=hotels_data)
plt.title('Bar Plot of Hotels')
plt.xlabel('Hotel Name')
plt.ylabel('Count')
plt.xticks(rotation=45)
plt.show()

# Users Data Visualizations
if 'travelCode' in users_data.columns:
    plt.figure(figsize=(8, 5))
    sns.countplot(x='travelCode', data=users_data)
    plt.title('Bar Plot of Travel Codes in Users Data')
    plt.xlabel('Travel Code')
    plt.ylabel('Count')
    plt.show()

# 3. Summarize 

print("\nSummary of Findings:")
print("1. The average flight price is", flights_data['price'].mean(), "with a standard deviation of", flights_data['price'].std(), ".")
print("2. The city with the highest average hotel prices is", hotels_data.groupby('place')['price'].mean().idxmax(), ".")
print("3. The most common flight type is", flights_data['flightType'].mode()[0], ".")
if 'travelCode' in users_data.columns:
    print("4. The most common travel code among users is", users_data['travelCode'].mode()[0], ".")
